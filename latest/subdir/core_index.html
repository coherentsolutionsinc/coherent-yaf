<!DOCTYPE html>
<html lang="">
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 2.0.18">
<title>Drivers</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700">
<style>
/*! Asciidoctor default stylesheet | MIT License | https://asciidoctor.org */
/* Uncomment the following line when using as a custom stylesheet */
/* @import "https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700"; */
html{font-family:sans-serif;-webkit-text-size-adjust:100%}
a{background:none}
a:focus{outline:thin dotted}
a:active,a:hover{outline:0}
h1{font-size:2em;margin:.67em 0}
b,strong{font-weight:bold}
abbr{font-size:.9em}
abbr[title]{cursor:help;border-bottom:1px dotted #dddddf;text-decoration:none}
dfn{font-style:italic}
hr{height:0}
mark{background:#ff0;color:#000}
code,kbd,pre,samp{font-family:monospace;font-size:1em}
pre{white-space:pre-wrap}
q{quotes:"\201C" "\201D" "\2018" "\2019"}
small{font-size:80%}
sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}
sup{top:-.5em}
sub{bottom:-.25em}
img{border:0}
svg:not(:root){overflow:hidden}
figure{margin:0}
audio,video{display:inline-block}
audio:not([controls]){display:none;height:0}
fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}
legend{border:0;padding:0}
button,input,select,textarea{font-family:inherit;font-size:100%;margin:0}
button,input{line-height:normal}
button,select{text-transform:none}
button,html input[type=button],input[type=reset],input[type=submit]{-webkit-appearance:button;cursor:pointer}
button[disabled],html input[disabled]{cursor:default}
input[type=checkbox],input[type=radio]{padding:0}
button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}
textarea{overflow:auto;vertical-align:top}
table{border-collapse:collapse;border-spacing:0}
*,::before,::after{box-sizing:border-box}
html,body{font-size:100%}
body{background:#fff;color:rgba(0,0,0,.8);padding:0;margin:0;font-family:"Noto Serif","DejaVu Serif",serif;line-height:1;position:relative;cursor:auto;-moz-tab-size:4;-o-tab-size:4;tab-size:4;word-wrap:anywhere;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased}
a:hover{cursor:pointer}
img,object,embed{max-width:100%;height:auto}
object,embed{height:100%}
img{-ms-interpolation-mode:bicubic}
.left{float:left!important}
.right{float:right!important}
.text-left{text-align:left!important}
.text-right{text-align:right!important}
.text-center{text-align:center!important}
.text-justify{text-align:justify!important}
.hide{display:none}
img,object,svg{display:inline-block;vertical-align:middle}
textarea{height:auto;min-height:50px}
select{width:100%}
.subheader,.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{line-height:1.45;color:#7a2518;font-weight:400;margin-top:0;margin-bottom:.25em}
div,dl,dt,dd,ul,ol,li,h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6,pre,form,p,blockquote,th,td{margin:0;padding:0}
a{color:#2156a5;text-decoration:underline;line-height:inherit}
a:hover,a:focus{color:#1d4b8f}
a img{border:0}
p{line-height:1.6;margin-bottom:1.25em;text-rendering:optimizeLegibility}
p aside{font-size:.875em;line-height:1.35;font-style:italic}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{font-family:"Open Sans","DejaVu Sans",sans-serif;font-weight:300;font-style:normal;color:#ba3925;text-rendering:optimizeLegibility;margin-top:1em;margin-bottom:.5em;line-height:1.0125em}
h1 small,h2 small,h3 small,#toctitle small,.sidebarblock>.content>.title small,h4 small,h5 small,h6 small{font-size:60%;color:#e99b8f;line-height:0}
h1{font-size:2.125em}
h2{font-size:1.6875em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.375em}
h4,h5{font-size:1.125em}
h6{font-size:1em}
hr{border:solid #dddddf;border-width:1px 0 0;clear:both;margin:1.25em 0 1.1875em}
em,i{font-style:italic;line-height:inherit}
strong,b{font-weight:bold;line-height:inherit}
small{font-size:60%;line-height:inherit}
code{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;color:rgba(0,0,0,.9)}
ul,ol,dl{line-height:1.6;margin-bottom:1.25em;list-style-position:outside;font-family:inherit}
ul,ol{margin-left:1.5em}
ul li ul,ul li ol{margin-left:1.25em;margin-bottom:0}
ul.circle{list-style-type:circle}
ul.disc{list-style-type:disc}
ul.square{list-style-type:square}
ul.circle ul:not([class]),ul.disc ul:not([class]),ul.square ul:not([class]){list-style:inherit}
ol li ul,ol li ol{margin-left:1.25em;margin-bottom:0}
dl dt{margin-bottom:.3125em;font-weight:bold}
dl dd{margin-bottom:1.25em}
blockquote{margin:0 0 1.25em;padding:.5625em 1.25em 0 1.1875em;border-left:1px solid #ddd}
blockquote,blockquote p{line-height:1.6;color:rgba(0,0,0,.85)}
@media screen and (min-width:768px){h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2}
h1{font-size:2.75em}
h2{font-size:2.3125em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.6875em}
h4{font-size:1.4375em}}
table{background:#fff;margin-bottom:1.25em;border:1px solid #dedede;word-wrap:normal}
table thead,table tfoot{background:#f7f8f7}
table thead tr th,table thead tr td,table tfoot tr th,table tfoot tr td{padding:.5em .625em .625em;font-size:inherit;color:rgba(0,0,0,.8);text-align:left}
table tr th,table tr td{padding:.5625em .625em;font-size:inherit;color:rgba(0,0,0,.8)}
table tr.even,table tr.alt{background:#f8f8f7}
table thead tr th,table tfoot tr th,table tbody tr td,table tr td,table tfoot tr td{line-height:1.6}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2;word-spacing:-.05em}
h1 strong,h2 strong,h3 strong,#toctitle strong,.sidebarblock>.content>.title strong,h4 strong,h5 strong,h6 strong{font-weight:400}
.center{margin-left:auto;margin-right:auto}
.stretch{width:100%}
.clearfix::before,.clearfix::after,.float-group::before,.float-group::after{content:" ";display:table}
.clearfix::after,.float-group::after{clear:both}
:not(pre).nobreak{word-wrap:normal}
:not(pre).nowrap{white-space:nowrap}
:not(pre).pre-wrap{white-space:pre-wrap}
:not(pre):not([class^=L])>code{font-size:.9375em;font-style:normal!important;letter-spacing:0;padding:.1em .5ex;word-spacing:-.15em;background:#f7f7f8;border-radius:4px;line-height:1.45;text-rendering:optimizeSpeed}
pre{color:rgba(0,0,0,.9);font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;line-height:1.45;text-rendering:optimizeSpeed}
pre code,pre pre{color:inherit;font-size:inherit;line-height:inherit}
pre>code{display:block}
pre.nowrap,pre.nowrap pre{white-space:pre;word-wrap:normal}
em em{font-style:normal}
strong strong{font-weight:400}
.keyseq{color:rgba(51,51,51,.8)}
kbd{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;display:inline-block;color:rgba(0,0,0,.8);font-size:.65em;line-height:1.45;background:#f7f7f7;border:1px solid #ccc;border-radius:3px;box-shadow:0 1px 0 rgba(0,0,0,.2),inset 0 0 0 .1em #fff;margin:0 .15em;padding:.2em .5em;vertical-align:middle;position:relative;top:-.1em;white-space:nowrap}
.keyseq kbd:first-child{margin-left:0}
.keyseq kbd:last-child{margin-right:0}
.menuseq,.menuref{color:#000}
.menuseq b:not(.caret),.menuref{font-weight:inherit}
.menuseq{word-spacing:-.02em}
.menuseq b.caret{font-size:1.25em;line-height:.8}
.menuseq i.caret{font-weight:bold;text-align:center;width:.45em}
b.button::before,b.button::after{position:relative;top:-1px;font-weight:400}
b.button::before{content:"[";padding:0 3px 0 2px}
b.button::after{content:"]";padding:0 2px 0 3px}
p a>code:hover{color:rgba(0,0,0,.9)}
#header,#content,#footnotes,#footer{width:100%;margin:0 auto;max-width:62.5em;*zoom:1;position:relative;padding-left:.9375em;padding-right:.9375em}
#header::before,#header::after,#content::before,#content::after,#footnotes::before,#footnotes::after,#footer::before,#footer::after{content:" ";display:table}
#header::after,#content::after,#footnotes::after,#footer::after{clear:both}
#content{margin-top:1.25em}
#content::before{content:none}
#header>h1:first-child{color:rgba(0,0,0,.85);margin-top:2.25rem;margin-bottom:0}
#header>h1:first-child+#toc{margin-top:8px;border-top:1px solid #dddddf}
#header>h1:only-child,body.toc2 #header>h1:nth-last-child(2){border-bottom:1px solid #dddddf;padding-bottom:8px}
#header .details{border-bottom:1px solid #dddddf;line-height:1.45;padding-top:.25em;padding-bottom:.25em;padding-left:.25em;color:rgba(0,0,0,.6);display:flex;flex-flow:row wrap}
#header .details span:first-child{margin-left:-.125em}
#header .details span.email a{color:rgba(0,0,0,.85)}
#header .details br{display:none}
#header .details br+span::before{content:"\00a0\2013\00a0"}
#header .details br+span.author::before{content:"\00a0\22c5\00a0";color:rgba(0,0,0,.85)}
#header .details br+span#revremark::before{content:"\00a0|\00a0"}
#header #revnumber{text-transform:capitalize}
#header #revnumber::after{content:"\00a0"}
#content>h1:first-child:not([class]){color:rgba(0,0,0,.85);border-bottom:1px solid #dddddf;padding-bottom:8px;margin-top:0;padding-top:1rem;margin-bottom:1.25rem}
#toc{border-bottom:1px solid #e7e7e9;padding-bottom:.5em}
#toc>ul{margin-left:.125em}
#toc ul.sectlevel0>li>a{font-style:italic}
#toc ul.sectlevel0 ul.sectlevel1{margin:.5em 0}
#toc ul{font-family:"Open Sans","DejaVu Sans",sans-serif;list-style-type:none}
#toc li{line-height:1.3334;margin-top:.3334em}
#toc a{text-decoration:none}
#toc a:active{text-decoration:underline}
#toctitle{color:#7a2518;font-size:1.2em}
@media screen and (min-width:768px){#toctitle{font-size:1.375em}
body.toc2{padding-left:15em;padding-right:0}
#toc.toc2{margin-top:0!important;background:#f8f8f7;position:fixed;width:15em;left:0;top:0;border-right:1px solid #e7e7e9;border-top-width:0!important;border-bottom-width:0!important;z-index:1000;padding:1.25em 1em;height:100%;overflow:auto}
#toc.toc2 #toctitle{margin-top:0;margin-bottom:.8rem;font-size:1.2em}
#toc.toc2>ul{font-size:.9em;margin-bottom:0}
#toc.toc2 ul ul{margin-left:0;padding-left:1em}
#toc.toc2 ul.sectlevel0 ul.sectlevel1{padding-left:0;margin-top:.5em;margin-bottom:.5em}
body.toc2.toc-right{padding-left:0;padding-right:15em}
body.toc2.toc-right #toc.toc2{border-right-width:0;border-left:1px solid #e7e7e9;left:auto;right:0}}
@media screen and (min-width:1280px){body.toc2{padding-left:20em;padding-right:0}
#toc.toc2{width:20em}
#toc.toc2 #toctitle{font-size:1.375em}
#toc.toc2>ul{font-size:.95em}
#toc.toc2 ul ul{padding-left:1.25em}
body.toc2.toc-right{padding-left:0;padding-right:20em}}
#content #toc{border:1px solid #e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;border-radius:4px}
#content #toc>:first-child{margin-top:0}
#content #toc>:last-child{margin-bottom:0}
#footer{max-width:none;background:rgba(0,0,0,.8);padding:1.25em}
#footer-text{color:hsla(0,0%,100%,.8);line-height:1.44}
#content{margin-bottom:.625em}
.sect1{padding-bottom:.625em}
@media screen and (min-width:768px){#content{margin-bottom:1.25em}
.sect1{padding-bottom:1.25em}}
.sect1:last-child{padding-bottom:0}
.sect1+.sect1{border-top:1px solid #e7e7e9}
#content h1>a.anchor,h2>a.anchor,h3>a.anchor,#toctitle>a.anchor,.sidebarblock>.content>.title>a.anchor,h4>a.anchor,h5>a.anchor,h6>a.anchor{position:absolute;z-index:1001;width:1.5ex;margin-left:-1.5ex;display:block;text-decoration:none!important;visibility:hidden;text-align:center;font-weight:400}
#content h1>a.anchor::before,h2>a.anchor::before,h3>a.anchor::before,#toctitle>a.anchor::before,.sidebarblock>.content>.title>a.anchor::before,h4>a.anchor::before,h5>a.anchor::before,h6>a.anchor::before{content:"\00A7";font-size:.85em;display:block;padding-top:.1em}
#content h1:hover>a.anchor,#content h1>a.anchor:hover,h2:hover>a.anchor,h2>a.anchor:hover,h3:hover>a.anchor,#toctitle:hover>a.anchor,.sidebarblock>.content>.title:hover>a.anchor,h3>a.anchor:hover,#toctitle>a.anchor:hover,.sidebarblock>.content>.title>a.anchor:hover,h4:hover>a.anchor,h4>a.anchor:hover,h5:hover>a.anchor,h5>a.anchor:hover,h6:hover>a.anchor,h6>a.anchor:hover{visibility:visible}
#content h1>a.link,h2>a.link,h3>a.link,#toctitle>a.link,.sidebarblock>.content>.title>a.link,h4>a.link,h5>a.link,h6>a.link{color:#ba3925;text-decoration:none}
#content h1>a.link:hover,h2>a.link:hover,h3>a.link:hover,#toctitle>a.link:hover,.sidebarblock>.content>.title>a.link:hover,h4>a.link:hover,h5>a.link:hover,h6>a.link:hover{color:#a53221}
details,.audioblock,.imageblock,.literalblock,.listingblock,.stemblock,.videoblock{margin-bottom:1.25em}
details{margin-left:1.25rem}
details>summary{cursor:pointer;display:block;position:relative;line-height:1.6;margin-bottom:.625rem;outline:none;-webkit-tap-highlight-color:transparent}
details>summary::-webkit-details-marker{display:none}
details>summary::before{content:"";border:solid transparent;border-left:solid;border-width:.3em 0 .3em .5em;position:absolute;top:.5em;left:-1.25rem;transform:translateX(15%)}
details[open]>summary::before{border:solid transparent;border-top:solid;border-width:.5em .3em 0;transform:translateY(15%)}
details>summary::after{content:"";width:1.25rem;height:1em;position:absolute;top:.3em;left:-1.25rem}
.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{text-rendering:optimizeLegibility;text-align:left;font-family:"Noto Serif","DejaVu Serif",serif;font-size:1rem;font-style:italic}
table.tableblock.fit-content>caption.title{white-space:nowrap;width:0}
.paragraph.lead>p,#preamble>.sectionbody>[class=paragraph]:first-of-type p{font-size:1.21875em;line-height:1.6;color:rgba(0,0,0,.85)}
.admonitionblock>table{border-collapse:separate;border:0;background:none;width:100%}
.admonitionblock>table td.icon{text-align:center;width:80px}
.admonitionblock>table td.icon img{max-width:none}
.admonitionblock>table td.icon .title{font-weight:bold;font-family:"Open Sans","DejaVu Sans",sans-serif;text-transform:uppercase}
.admonitionblock>table td.content{padding-left:1.125em;padding-right:1.25em;border-left:1px solid #dddddf;color:rgba(0,0,0,.6);word-wrap:anywhere}
.admonitionblock>table td.content>:last-child>:last-child{margin-bottom:0}
.exampleblock>.content{border:1px solid #e6e6e6;margin-bottom:1.25em;padding:1.25em;background:#fff;border-radius:4px}
.exampleblock>.content>:first-child{margin-top:0}
.exampleblock>.content>:last-child{margin-bottom:0}
.sidebarblock{border:1px solid #dbdbd6;margin-bottom:1.25em;padding:1.25em;background:#f3f3f2;border-radius:4px}
.sidebarblock>:first-child{margin-top:0}
.sidebarblock>:last-child{margin-bottom:0}
.sidebarblock>.content>.title{color:#7a2518;margin-top:0;text-align:center}
.exampleblock>.content>:last-child>:last-child,.exampleblock>.content .olist>ol>li:last-child>:last-child,.exampleblock>.content .ulist>ul>li:last-child>:last-child,.exampleblock>.content .qlist>ol>li:last-child>:last-child,.sidebarblock>.content>:last-child>:last-child,.sidebarblock>.content .olist>ol>li:last-child>:last-child,.sidebarblock>.content .ulist>ul>li:last-child>:last-child,.sidebarblock>.content .qlist>ol>li:last-child>:last-child{margin-bottom:0}
.literalblock pre,.listingblock>.content>pre{border-radius:4px;overflow-x:auto;padding:1em;font-size:.8125em}
@media screen and (min-width:768px){.literalblock pre,.listingblock>.content>pre{font-size:.90625em}}
@media screen and (min-width:1280px){.literalblock pre,.listingblock>.content>pre{font-size:1em}}
.literalblock pre,.listingblock>.content>pre:not(.highlight),.listingblock>.content>pre[class=highlight],.listingblock>.content>pre[class^="highlight "]{background:#f7f7f8}
.literalblock.output pre{color:#f7f7f8;background:rgba(0,0,0,.9)}
.listingblock>.content{position:relative}
.listingblock code[data-lang]::before{display:none;content:attr(data-lang);position:absolute;font-size:.75em;top:.425rem;right:.5rem;line-height:1;text-transform:uppercase;color:inherit;opacity:.5}
.listingblock:hover code[data-lang]::before{display:block}
.listingblock.terminal pre .command::before{content:attr(data-prompt);padding-right:.5em;color:inherit;opacity:.5}
.listingblock.terminal pre .command:not([data-prompt])::before{content:"$"}
.listingblock pre.highlightjs{padding:0}
.listingblock pre.highlightjs>code{padding:1em;border-radius:4px}
.listingblock pre.prettyprint{border-width:0}
.prettyprint{background:#f7f7f8}
pre.prettyprint .linenums{line-height:1.45;margin-left:2em}
pre.prettyprint li{background:none;list-style-type:inherit;padding-left:0}
pre.prettyprint li code[data-lang]::before{opacity:1}
pre.prettyprint li:not(:first-child) code[data-lang]::before{display:none}
table.linenotable{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.linenotable td[class]{color:inherit;vertical-align:top;padding:0;line-height:inherit;white-space:normal}
table.linenotable td.code{padding-left:.75em}
table.linenotable td.linenos,pre.pygments .linenos{border-right:1px solid;opacity:.35;padding-right:.5em;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}
pre.pygments span.linenos{display:inline-block;margin-right:.75em}
.quoteblock{margin:0 1em 1.25em 1.5em;display:table}
.quoteblock:not(.excerpt)>.title{margin-left:-1.5em;margin-bottom:.75em}
.quoteblock blockquote,.quoteblock p{color:rgba(0,0,0,.85);font-size:1.15rem;line-height:1.75;word-spacing:.1em;letter-spacing:0;font-style:italic;text-align:justify}
.quoteblock blockquote{margin:0;padding:0;border:0}
.quoteblock blockquote::before{content:"\201c";float:left;font-size:2.75em;font-weight:bold;line-height:.6em;margin-left:-.6em;color:#7a2518;text-shadow:0 1px 2px rgba(0,0,0,.1)}
.quoteblock blockquote>.paragraph:last-child p{margin-bottom:0}
.quoteblock .attribution{margin-top:.75em;margin-right:.5ex;text-align:right}
.verseblock{margin:0 1em 1.25em}
.verseblock pre{font-family:"Open Sans","DejaVu Sans",sans-serif;font-size:1.15rem;color:rgba(0,0,0,.85);font-weight:300;text-rendering:optimizeLegibility}
.verseblock pre strong{font-weight:400}
.verseblock .attribution{margin-top:1.25rem;margin-left:.5ex}
.quoteblock .attribution,.verseblock .attribution{font-size:.9375em;line-height:1.45;font-style:italic}
.quoteblock .attribution br,.verseblock .attribution br{display:none}
.quoteblock .attribution cite,.verseblock .attribution cite{display:block;letter-spacing:-.025em;color:rgba(0,0,0,.6)}
.quoteblock.abstract blockquote::before,.quoteblock.excerpt blockquote::before,.quoteblock .quoteblock blockquote::before{display:none}
.quoteblock.abstract blockquote,.quoteblock.abstract p,.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{line-height:1.6;word-spacing:0}
.quoteblock.abstract{margin:0 1em 1.25em;display:block}
.quoteblock.abstract>.title{margin:0 0 .375em;font-size:1.15em;text-align:center}
.quoteblock.excerpt>blockquote,.quoteblock .quoteblock{padding:0 0 .25em 1em;border-left:.25em solid #dddddf}
.quoteblock.excerpt,.quoteblock .quoteblock{margin-left:0}
.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{color:inherit;font-size:1.0625rem}
.quoteblock.excerpt .attribution,.quoteblock .quoteblock .attribution{color:inherit;font-size:.85rem;text-align:left;margin-right:0}
p.tableblock:last-child{margin-bottom:0}
td.tableblock>.content{margin-bottom:1.25em;word-wrap:anywhere}
td.tableblock>.content>:last-child{margin-bottom:-1.25em}
table.tableblock,th.tableblock,td.tableblock{border:0 solid #dedede}
table.grid-all>*>tr>*{border-width:1px}
table.grid-cols>*>tr>*{border-width:0 1px}
table.grid-rows>*>tr>*{border-width:1px 0}
table.frame-all{border-width:1px}
table.frame-ends{border-width:1px 0}
table.frame-sides{border-width:0 1px}
table.frame-none>colgroup+*>:first-child>*,table.frame-sides>colgroup+*>:first-child>*{border-top-width:0}
table.frame-none>:last-child>:last-child>*,table.frame-sides>:last-child>:last-child>*{border-bottom-width:0}
table.frame-none>*>tr>:first-child,table.frame-ends>*>tr>:first-child{border-left-width:0}
table.frame-none>*>tr>:last-child,table.frame-ends>*>tr>:last-child{border-right-width:0}
table.stripes-all>*>tr,table.stripes-odd>*>tr:nth-of-type(odd),table.stripes-even>*>tr:nth-of-type(even),table.stripes-hover>*>tr:hover{background:#f8f8f7}
th.halign-left,td.halign-left{text-align:left}
th.halign-right,td.halign-right{text-align:right}
th.halign-center,td.halign-center{text-align:center}
th.valign-top,td.valign-top{vertical-align:top}
th.valign-bottom,td.valign-bottom{vertical-align:bottom}
th.valign-middle,td.valign-middle{vertical-align:middle}
table thead th,table tfoot th{font-weight:bold}
tbody tr th{background:#f7f8f7}
tbody tr th,tbody tr th p,tfoot tr th,tfoot tr th p{color:rgba(0,0,0,.8);font-weight:bold}
p.tableblock>code:only-child{background:none;padding:0}
p.tableblock{font-size:1em}
ol{margin-left:1.75em}
ul li ol{margin-left:1.5em}
dl dd{margin-left:1.125em}
dl dd:last-child,dl dd:last-child>:last-child{margin-bottom:0}
li p,ul dd,ol dd,.olist .olist,.ulist .ulist,.ulist .olist,.olist .ulist{margin-bottom:.625em}
ul.checklist,ul.none,ol.none,ul.no-bullet,ol.no-bullet,ol.unnumbered,ul.unstyled,ol.unstyled{list-style-type:none}
ul.no-bullet,ol.no-bullet,ol.unnumbered{margin-left:.625em}
ul.unstyled,ol.unstyled{margin-left:0}
li>p:empty:only-child::before{content:"";display:inline-block}
ul.checklist>li>p:first-child{margin-left:-1em}
ul.checklist>li>p:first-child>.fa-square-o:first-child,ul.checklist>li>p:first-child>.fa-check-square-o:first-child{width:1.25em;font-size:.8em;position:relative;bottom:.125em}
ul.checklist>li>p:first-child>input[type=checkbox]:first-child{margin-right:.25em}
ul.inline{display:flex;flex-flow:row wrap;list-style:none;margin:0 0 .625em -1.25em}
ul.inline>li{margin-left:1.25em}
.unstyled dl dt{font-weight:400;font-style:normal}
ol.arabic{list-style-type:decimal}
ol.decimal{list-style-type:decimal-leading-zero}
ol.loweralpha{list-style-type:lower-alpha}
ol.upperalpha{list-style-type:upper-alpha}
ol.lowerroman{list-style-type:lower-roman}
ol.upperroman{list-style-type:upper-roman}
ol.lowergreek{list-style-type:lower-greek}
.hdlist>table,.colist>table{border:0;background:none}
.hdlist>table>tbody>tr,.colist>table>tbody>tr{background:none}
td.hdlist1,td.hdlist2{vertical-align:top;padding:0 .625em}
td.hdlist1{font-weight:bold;padding-bottom:1.25em}
td.hdlist2{word-wrap:anywhere}
.literalblock+.colist,.listingblock+.colist{margin-top:-.5em}
.colist td:not([class]):first-child{padding:.4em .75em 0;line-height:1;vertical-align:top}
.colist td:not([class]):first-child img{max-width:none}
.colist td:not([class]):last-child{padding:.25em 0}
.thumb,.th{line-height:0;display:inline-block;border:4px solid #fff;box-shadow:0 0 0 1px #ddd}
.imageblock.left{margin:.25em .625em 1.25em 0}
.imageblock.right{margin:.25em 0 1.25em .625em}
.imageblock>.title{margin-bottom:0}
.imageblock.thumb,.imageblock.th{border-width:6px}
.imageblock.thumb>.title,.imageblock.th>.title{padding:0 .125em}
.image.left,.image.right{margin-top:.25em;margin-bottom:.25em;display:inline-block;line-height:0}
.image.left{margin-right:.625em}
.image.right{margin-left:.625em}
a.image{text-decoration:none;display:inline-block}
a.image object{pointer-events:none}
sup.footnote,sup.footnoteref{font-size:.875em;position:static;vertical-align:super}
sup.footnote a,sup.footnoteref a{text-decoration:none}
sup.footnote a:active,sup.footnoteref a:active{text-decoration:underline}
#footnotes{padding-top:.75em;padding-bottom:.75em;margin-bottom:.625em}
#footnotes hr{width:20%;min-width:6.25em;margin:-.25em 0 .75em;border-width:1px 0 0}
#footnotes .footnote{padding:0 .375em 0 .225em;line-height:1.3334;font-size:.875em;margin-left:1.2em;margin-bottom:.2em}
#footnotes .footnote a:first-of-type{font-weight:bold;text-decoration:none;margin-left:-1.05em}
#footnotes .footnote:last-of-type{margin-bottom:0}
#content #footnotes{margin-top:-.625em;margin-bottom:0;padding:.75em 0}
div.unbreakable{page-break-inside:avoid}
.big{font-size:larger}
.small{font-size:smaller}
.underline{text-decoration:underline}
.overline{text-decoration:overline}
.line-through{text-decoration:line-through}
.aqua{color:#00bfbf}
.aqua-background{background:#00fafa}
.black{color:#000}
.black-background{background:#000}
.blue{color:#0000bf}
.blue-background{background:#0000fa}
.fuchsia{color:#bf00bf}
.fuchsia-background{background:#fa00fa}
.gray{color:#606060}
.gray-background{background:#7d7d7d}
.green{color:#006000}
.green-background{background:#007d00}
.lime{color:#00bf00}
.lime-background{background:#00fa00}
.maroon{color:#600000}
.maroon-background{background:#7d0000}
.navy{color:#000060}
.navy-background{background:#00007d}
.olive{color:#606000}
.olive-background{background:#7d7d00}
.purple{color:#600060}
.purple-background{background:#7d007d}
.red{color:#bf0000}
.red-background{background:#fa0000}
.silver{color:#909090}
.silver-background{background:#bcbcbc}
.teal{color:#006060}
.teal-background{background:#007d7d}
.white{color:#bfbfbf}
.white-background{background:#fafafa}
.yellow{color:#bfbf00}
.yellow-background{background:#fafa00}
span.icon>.fa{cursor:default}
a span.icon>.fa{cursor:inherit}
.admonitionblock td.icon [class^="fa icon-"]{font-size:2.5em;text-shadow:1px 1px 2px rgba(0,0,0,.5);cursor:default}
.admonitionblock td.icon .icon-note::before{content:"\f05a";color:#19407c}
.admonitionblock td.icon .icon-tip::before{content:"\f0eb";text-shadow:1px 1px 2px rgba(155,155,0,.8);color:#111}
.admonitionblock td.icon .icon-warning::before{content:"\f071";color:#bf6900}
.admonitionblock td.icon .icon-caution::before{content:"\f06d";color:#bf3400}
.admonitionblock td.icon .icon-important::before{content:"\f06a";color:#bf0000}
.conum[data-value]{display:inline-block;color:#fff!important;background:rgba(0,0,0,.8);border-radius:50%;text-align:center;font-size:.75em;width:1.67em;height:1.67em;line-height:1.67em;font-family:"Open Sans","DejaVu Sans",sans-serif;font-style:normal;font-weight:bold}
.conum[data-value] *{color:#fff!important}
.conum[data-value]+b{display:none}
.conum[data-value]::after{content:attr(data-value)}
pre .conum[data-value]{position:relative;top:-.125em}
b.conum *{color:inherit!important}
.conum:not([data-value]):empty{display:none}
dt,th.tableblock,td.content,div.footnote{text-rendering:optimizeLegibility}
h1,h2,p,td.content,span.alt,summary{letter-spacing:-.01em}
p strong,td.content strong,div.footnote strong{letter-spacing:-.005em}
p,blockquote,dt,td.content,span.alt,summary{font-size:1.0625rem}
p{margin-bottom:1.25rem}
.sidebarblock p,.sidebarblock dt,.sidebarblock td.content,p.tableblock{font-size:1em}
.exampleblock>.content{background:#fffef7;border-color:#e0e0dc;box-shadow:0 1px 4px #e0e0dc}
.print-only{display:none!important}
@page{margin:1.25cm .75cm}
@media print{*{box-shadow:none!important;text-shadow:none!important}
html{font-size:80%}
a{color:inherit!important;text-decoration:underline!important}
a.bare,a[href^="#"],a[href^="mailto:"]{text-decoration:none!important}
a[href^="http:"]:not(.bare)::after,a[href^="https:"]:not(.bare)::after{content:"(" attr(href) ")";display:inline-block;font-size:.875em;padding-left:.25em}
abbr[title]{border-bottom:1px dotted}
abbr[title]::after{content:" (" attr(title) ")"}
pre,blockquote,tr,img,object,svg{page-break-inside:avoid}
thead{display:table-header-group}
svg{max-width:100%}
p,blockquote,dt,td.content{font-size:1em;orphans:3;widows:3}
h2,h3,#toctitle,.sidebarblock>.content>.title{page-break-after:avoid}
#header,#content,#footnotes,#footer{max-width:none}
#toc,.sidebarblock,.exampleblock>.content{background:none!important}
#toc{border-bottom:1px solid #dddddf!important;padding-bottom:0!important}
body.book #header{text-align:center}
body.book #header>h1:first-child{border:0!important;margin:2.5em 0 1em}
body.book #header .details{border:0!important;display:block;padding:0!important}
body.book #header .details span:first-child{margin-left:0!important}
body.book #header .details br{display:block}
body.book #header .details br+span::before{content:none!important}
body.book #toc{border:0!important;text-align:left!important;padding:0!important;margin:0!important}
body.book #toc,body.book #preamble,body.book h1.sect0,body.book .sect1>h2{page-break-before:always}
.listingblock code[data-lang]::before{display:block}
#footer{padding:0 .9375em}
.hide-on-print{display:none!important}
.print-only{display:block!important}
.hide-for-print{display:none!important}
.show-for-print{display:inherit!important}}
@media amzn-kf8,print{#header>h1:first-child{margin-top:1.25rem}
.sect1{padding:0!important}
.sect1+.sect1{border:0}
#footer{background:none}
#footer-text{color:rgba(0,0,0,.6);font-size:.9em}}
@media amzn-kf8{#header,#content,#footnotes,#footer{padding:0}}
</style>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
<style>
pre.rouge table td { padding: 5px; }
pre.rouge table pre { margin: 0; }
pre.rouge .cm {
  color: #999988;
  font-style: italic;
}
pre.rouge .cp {
  color: #999999;
  font-weight: bold;
}
pre.rouge .c1 {
  color: #999988;
  font-style: italic;
}
pre.rouge .cs {
  color: #999999;
  font-weight: bold;
  font-style: italic;
}
pre.rouge .c, pre.rouge .ch, pre.rouge .cd, pre.rouge .cpf {
  color: #999988;
  font-style: italic;
}
pre.rouge .err {
  color: #a61717;
  background-color: #e3d2d2;
}
pre.rouge .gd {
  color: #000000;
  background-color: #ffdddd;
}
pre.rouge .ge {
  color: #000000;
  font-style: italic;
}
pre.rouge .gr {
  color: #aa0000;
}
pre.rouge .gh {
  color: #999999;
}
pre.rouge .gi {
  color: #000000;
  background-color: #ddffdd;
}
pre.rouge .go {
  color: #888888;
}
pre.rouge .gp {
  color: #555555;
}
pre.rouge .gs {
  font-weight: bold;
}
pre.rouge .gu {
  color: #aaaaaa;
}
pre.rouge .gt {
  color: #aa0000;
}
pre.rouge .kc {
  color: #000000;
  font-weight: bold;
}
pre.rouge .kd {
  color: #000000;
  font-weight: bold;
}
pre.rouge .kn {
  color: #000000;
  font-weight: bold;
}
pre.rouge .kp {
  color: #000000;
  font-weight: bold;
}
pre.rouge .kr {
  color: #000000;
  font-weight: bold;
}
pre.rouge .kt {
  color: #445588;
  font-weight: bold;
}
pre.rouge .k, pre.rouge .kv {
  color: #000000;
  font-weight: bold;
}
pre.rouge .mf {
  color: #009999;
}
pre.rouge .mh {
  color: #009999;
}
pre.rouge .il {
  color: #009999;
}
pre.rouge .mi {
  color: #009999;
}
pre.rouge .mo {
  color: #009999;
}
pre.rouge .m, pre.rouge .mb, pre.rouge .mx {
  color: #009999;
}
pre.rouge .sa {
  color: #000000;
  font-weight: bold;
}
pre.rouge .sb {
  color: #d14;
}
pre.rouge .sc {
  color: #d14;
}
pre.rouge .sd {
  color: #d14;
}
pre.rouge .s2 {
  color: #d14;
}
pre.rouge .se {
  color: #d14;
}
pre.rouge .sh {
  color: #d14;
}
pre.rouge .si {
  color: #d14;
}
pre.rouge .sx {
  color: #d14;
}
pre.rouge .sr {
  color: #009926;
}
pre.rouge .s1 {
  color: #d14;
}
pre.rouge .ss {
  color: #990073;
}
pre.rouge .s, pre.rouge .dl {
  color: #d14;
}
pre.rouge .na {
  color: #008080;
}
pre.rouge .bp {
  color: #999999;
}
pre.rouge .nb {
  color: #0086B3;
}
pre.rouge .nc {
  color: #445588;
  font-weight: bold;
}
pre.rouge .no {
  color: #008080;
}
pre.rouge .nd {
  color: #3c5d5d;
  font-weight: bold;
}
pre.rouge .ni {
  color: #800080;
}
pre.rouge .ne {
  color: #990000;
  font-weight: bold;
}
pre.rouge .nf, pre.rouge .fm {
  color: #990000;
  font-weight: bold;
}
pre.rouge .nl {
  color: #990000;
  font-weight: bold;
}
pre.rouge .nn {
  color: #555555;
}
pre.rouge .nt {
  color: #000080;
}
pre.rouge .vc {
  color: #008080;
}
pre.rouge .vg {
  color: #008080;
}
pre.rouge .vi {
  color: #008080;
}
pre.rouge .nv, pre.rouge .vm {
  color: #008080;
}
pre.rouge .ow {
  color: #000000;
  font-weight: bold;
}
pre.rouge .o {
  color: #000000;
  font-weight: bold;
}
pre.rouge .w {
  color: #bbbbbb;
}
pre.rouge {
  background-color: #f8f8f8;
}
</style>
</head>
<body class="article toc2 toc-left">
<div id="header">
<div id="toc" class="toc2">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel2">
<li><a href="#drivers">Drivers</a></li>
<li><a href="#context">Context</a></li>
<li><a href="#config-manager">Config Manager</a></li>
<li><a href="#data-management">Data Management</a></li>
<li><a href="#api">API</a></li>
<li><a href="#conditions">Conditions</a></li>
<li><a href="#yaf-reporting">YAF reporting</a></li>
<li><a href="#slack">Slack</a></li>
<li><a href="#utils">Utils</a></li>
</ul>
</div>
</div>
<div id="content">
<div class="sect2">
<h3 id="drivers">Drivers</h3>
<div class="paragraph">
<p>In Yaf Selenium WebDriver is represented by <a href="../javadoc/com/coherentsolutions/yaf/core/drivers/model/DriverHolder.html"><code>DriverHolder</code></a>. In its turn they are stored inside DriversStore under corresponding Yaf Device key. DriverHolder contains additional driver information that helps operate drivers. One on the usefull driver&#8217;s characteristic is scope. There are four of these:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>EXECUTION - for common/default driver, only one per execution exist. Used in case no <a href="config.adoc">configurations</a> is used</p>
</li>
<li>
<p>SUITE - for suite specific driver, stored in suit name - driverHolder map, is there is no driver for corresponding suite EXECUTION scope driver is used</p>
</li>
<li>
<p>CLASS - is assigned to the driver in case parallelization by classes</p>
</li>
<li>
<p>METHOD - is assigned to the driver in case parallelization by medhods</p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="context">Context</h3>
<div class="paragraph">
<p>In addition to the standard <a href="https://docs.spring.io/spring-framework/docs/current/javadoc-api/org/springframework/context/ApplicationContext.html">Spring context</a>, there are two extra custom contexts in YAF.</p>
</div>
<div class="paragraph">
<p>The context&#8217;s tasks are:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>To store all information about the test execution process;</p>
</li>
<li>
<p>To be the basis for decision-making about the type of object that needs to be injected.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>The framework has two custom contexts:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><code>ExecutionContext</code> - a global test execution context.</p>
</li>
<li>
<p><code>TestExecutionContext</code> - a local test execution context.</p>
</li>
</ol>
</div>
<div class="sect3">
<h4 id="executioncontext">ExecutionContext</h4>
<div class="paragraph">
<p>ExecutionContext contains global information and launch parameters, also manages drivers with <strong>Execution</strong> and <strong>Suite</strong> scopes.</p>
</div>
<div class="paragraph">
<p>This context is created when the application starts and is cleared after the application quits.</p>
</div>
</div>
<div class="sect3">
<h4 id="testexecutioncontext">TestExecutionContext</h4>
<div class="paragraph">
<p>TestExecutionContext manages drivers with <strong>Test</strong> and <strong>Class</strong> scopes, and contains information about the current test, such as:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>test name;</p>
</li>
<li>
<p>suite name;</p>
</li>
<li>
<p>current environment;</p>
</li>
<li>
<p>start time</p>
</li>
<li>
<p>current <a href="config.adoc#additional_config">additional config</a></p>
</li>
<li>
<p>a <a href="../javadoc/com/coherentsolutions/yaf/core/test/model/TestInfo.html"><code>TestInfo</code></a> object with a lot of additional information about the test.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>This context is created when the test starts (TestStartEvent) and is cleared when the test ends.</p>
</div>
</div>
<div class="sect3">
<h4 id="how-is-it-used">How is it used</h4>
<div class="paragraph">
<p>These contexts are accessible inside BaseYafTest, Component and Utils classes and its inheritor classes
Contexts are participate in the one of the first command trying to start your first test (link:firstWebTest.adoc):</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">FirstTest</span> <span class="kd">extends</span> <span class="nc">YafTestNgTest</span> <span class="o">{</span> <i class="conum" data-value="1"></i><b>(1)</b>

    <span class="nd">@Test</span>
    <span class="nd">@YafTest</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">sampleTest</span><span class="o">(){</span>
        <span class="nc">WebDriver</span> <span class="n">driver</span> <span class="o">=</span> <span class="o">(</span><span class="nc">WebDriver</span><span class="o">)</span> <span class="n">getWebDriver</span><span class="o">().</span><span class="na">getDriver</span><span class="o">();</span> <i class="conum" data-value="1"></i><b>(1)</b>
        <span class="nc">WebDriver</span> <span class="n">firefoxDriver</span> <span class="o">=</span> <span class="o">(</span><span class="nc">WebDriver</span><span class="o">)</span> <span class="n">getWebDriver</span><span class="o">(</span><span class="s">"ff"</span><span class="o">).</span><span class="na">getDriver</span><span class="o">();</span> <i class="conum" data-value="2"></i><b>(2)</b>
    <span class="o">}</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
&lt;1&gt; getWebDriver()/getMobileDriver()/getDesktopDriver() of BaseYafTest return a Driver Holder instance of corresponding type Web/Mobile/Desktop. It applies to testExecutionContext and then to executionContext driver store for the required driver, created new and add it to testContext if existing one was not found. In &lt;2&gt; case to type filter device name(one of devices that are defined for current environment, <a href="config.adoc">see</a>) will be added
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>By YAF getDriver methods are used during pages and components class files initializing to assign to each of them a driverHolder for further usage orchestrating app&#8217;s pages and components</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="config-manager">Config Manager</h3>
<div class="paragraph">
<p>Executing tests with complex configurations can be quite a challenge.
For example, you need to run tests against/on multiple browsers, mobile devices, different languages, etc.
Such a task requires a lot of effort and sometimes can be confusing.
YAF config manager will help to cope with such confusing cases.</p>
</div>
<div class="paragraph">
<p>The main objects of the config manager:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Device - device on which the tests are executed, it can be a web browser, a mobile device, a desktop;</p>
</li>
<li>
<p>Configuration - a typed object that represents an additional configuration of the execution, such as locale or user for instance;</p>
</li>
<li>
<p>Environment - a set of devices and configurations for single test execution, for example, you need to test something in a browser and on a mobile device, with a specific locale and user;</p>
</li>
<li>
<p>Execution - the set of environments where you need to execute the tests and parallel settings of the execution;</p>
</li>
<li>
<p>Farm - a farm of devices, cloud provider, &#8230;&#8203; - provider of devices for tests execution.</p>
</li>
</ul>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
The configuration manager supports many sources of configurations, in the basic package it reads configuration from JSON files.
These readers will also be used in the examples.
</td>
</tr>
</table>
</div>
<div class="sect3">
<h4 id="how-to">How to</h4>
<div class="sect4">
<h5 id="how-to-use">How to use</h5>
<div class="paragraph">
<p>To use the configuration manager, you should:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Import yaf-exec-config-json dependency to your pom.xml/build.gradle</p>
<details>
<summary class="title">Maven</summary>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="xml">        <span class="nt">&lt;dependency&gt;</span>
            <span class="nt">&lt;groupId&gt;</span>com.coherentsolutions.yaf<span class="nt">&lt;/groupId&gt;</span>
            <span class="nt">&lt;artifactId&gt;</span>yaf-exec-config-json<span class="nt">&lt;/artifactId&gt;</span>
            <span class="nt">&lt;version&gt;</span>${yaf.version}<span class="nt">&lt;/version&gt;</span>
        <span class="nt">&lt;/dependency&gt;</span></code></pre>
</div>
</div>
</div>
</details>
<details>
<summary class="title">Gradle</summary>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="groovy"><span class="n">dependencies</span> <span class="o">{</span>
    <span class="n">implementation</span><span class="o">(</span><span class="s2">"com.coherentsolutions.yaf:yaf-exec-config-json:${yaf.version}"</span><span class="o">)</span>
<span class="o">}</span></code></pre>
</div>
</div>
</div>
</details>
</li>
<li>
<p>In the folder with test resources create a directory structure</p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="bash">- execute
  |- config
  |- data
  |- device
  |- <span class="nb">env</span>
  |- farm
  |- xxx_config_file.json</code></pre>
</div>
</div>
</li>
<li>
<p>For base configuration at least 2 files should be created</p>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
configuration manager supports both JSON files and <a href="https://json5.org/">JSON5</a>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<div class="title">Device File*</div>
<p>File with a random name in the directory <code>device</code></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="json5">{
  "chrome": {
    "type": "web",
    "browser": "chrome",
    "args": [
      "--start-maximized",
      "--disable-browser-side-navigation",
    ],
    "capabilities": {
      "pageLoadStrategy": "normal"
    }
  },
  "ff": {
    "type": "web",
    "browser": "ff",
    "args": [
      "--start-maximized",
      "--disable-browser-side-navigation"
    ],
    "capabilities": {
      "pageLoadStrategy": "normal"
    }
  }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>For specific device syntax see <a href="../javadoc/com/coherentsolutions/yaf/core/exec/model/device/BrowserDevice.html">BrowserDevice</a>, <a href="../javadoc/com/coherentsolutions/yaf/core/exec/model/device/MobileDevice.html">MobileDevice</a>, &#8230;&#8203;</p>
</div>
<div id="config_file" class="paragraph">
<div class="title">General configuration File</div>
<p>Is a file in execute derictory. In this file, you should to fill in some sections (* - required):</p>
</div>
<div class="ulist">
<ul>
<li>
<p>name* - configuration name;</p>
</li>
<li>
<p>envs* - in this block you should specify the list of environments and determine which devices will belong to the particular environment;</p>
</li>
<li>
<p>envsNames - if you want to put the configuration of the environments into separate files for further reuse, specify the names of the environments in this block (the files should be placed in the <strong>env</strong> folder);</p>
</li>
<li>
<p><a href="#additional_config">configs</a> - if you want to additionally parameterize your run (not only by devices) and specify, for example, a list of user roles, you should enter them in this section as a key/value;</p>
</li>
<li>
<p>configNames - the same logic as with the list of environments: you specify the names of configurations (files must be placed in the <strong>config</strong> folder);</p>
</li>
<li>
<p><a href="#farms_config">farmNames</a> - if your configuration implies tests execution on farms, you should specify them in this list.</p>
</li>
<li>
<p><a href="#parallel_execution">setup</a>- if you want to decrease tests run execution time use setup block to configure parallel execution.</p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="json5">{
  "name": "smoke",
  "envs": {
    "set1": {
      "devices": [
        "chrome",
        "ff"
      ]
    },
    "set2": {
      "devices": [
        "chrome",
      ]
    }
  }
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">If you desire to reuse your env define a file with a random name in the directory <code>env</code></div>
<div class="content">
<pre class="rouge highlight"><code data-lang="json5">{
  "env1": {
    "devices": [
      "chrome",
      "ff"
    ]
  },
  "env2": {
    "devices": [
      "chrome"
    ]
  }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Then your general configuration file will look like this</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="json5">{
  "name": "smoke",
  "envsNames": [
    "env1",
    "env2"
  ]
}</code></pre>
</div>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>Finally define your configuration file name as environment variable with envSettings key running your tests. Otherwise, default_env (chrome, latest version) is used. For example, envSettings=f_config_file</p>
</li>
</ol>
</div>
</div>
<div class="sect4">
<h5 id="additional_config">Additional config</h5>
<div class="listingblock">
<div class="title">Providing extra configuration</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="json5">{
  "name": "smoke",
  "configs": [
    {
      "user": "admin",
      "locale": "ru"
    },
    {
      "user": "admin",
      "locale": "eng"
    }
  ],
  "envsNames": [
    "env1",
    "env2"
  ]
}</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
User and locale current values could be accessible in <a href="context.adoc">TestExecutionContext&#8217;s</a> params. For current example it will store DefaultYafUser with 'admin' username and password under 'user' key and java Locale object with provided language under 'locale' key. To see details of implementation and to create other config like user and locale <a href="#how_to_extend">see</a>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>If you desire to reuse config the same process as in case of environments works:</p>
</div>
<div class="paragraph">
<p>File in <code>configs</code> folder:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="json5">{
  "ruUser": {
    "user": "user1",
    "locale": "ru"
  },
  "enUser": {
    "user": "user1",
    "locale": "en"
  }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>And general config file:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="json5">{
  "name": "smoke",
  "configNames": [
    "ruUser",
    "enUser"
  ],
  "envsNames": [
    "env1",
    "env2"
  ]
}</code></pre>
</div>
</div>
<div id="farms_config" class="listingblock">
<div class="title">Farms configuration file</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="json5">{
  bs: {
    url: "http://",
    user: "xxx",
    key: "yyyy",
    supportedTypes: [
      "web"
    ]
  },
  local: {
    supportedTypes: [
      "web",
      "mobile"
    ]
  }
}</code></pre>
</div>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
Farms are matched to devices by type, i.e. if a farm is configured as a web farm, all web devices will run on this farm. At the same time if there are 2 farms for a mobile device, but one of them is purely mobile, and the other is both mobile and web, then purely mobile farm will be used by priority.
</td>
</tr>
</table>
</div>
<div id="parallel_execution" class="paragraph">
<div class="title">Parallelization config</div>
<p>Parallelization config consists of TestNG suite attributes like <a href="https://testng.org/#_parallel_tests_classes_and_methods">parallel modes</a> and threadCount. .suiteThreadCount is used if several environments are defined and multiple suites is about to be run. Define it to run that suits in parallel.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="json5">{
  "name": "smoke",
  "envsNames": [
    "env1", "env2"
  ],
  "setup": {
    "suiteThreadsCount": 1,
    "threadsCount": 1,
    "parallelMode": "CLASSES"
  }
}</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="how-it-works">How it works</h5>
<div class="paragraph">
<p>The upper-level process goes as follows:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>When tests are invoked, the defined configuration <a href="#config_file">General configuration File</a> is read and an execution configuration <code>ExecutionConfiguration</code> is generated.</p>
<div class="paragraph">
<p>Then, in <code>ExecutionConfiguration</code> an array of runs of all environments against all configurations is generated.
For example, we have 2 users (administrator, manager) and 2 browsers (Chrome and FF), as a result of this formation, tests will be executed 4 times:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Chrome Admin</p>
</li>
<li>
<p>Chrome Manager</p>
</li>
<li>
<p>FF Admin</p>
</li>
<li>
<p>FF Manager</p>
<div class="paragraph">
<p>And this principle can be replicated for any type of configuration.</p>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>The original test suite is modified to fit the configuration (more in <a href="https://testng.org/#_testng_xml">TestNG</a>)</p>
</li>
<li>
<p>When running a particular test, based on the configuration in step 2, we get an <code>Environment</code> object, which contains a list of devices to run, as well as a set of configurations.
Then, we go through the list of configurations, find a corresponding resolver (see next section) and apply this configuration to the test execution context.</p>
</li>
</ol>
</div>
</div>
<div class="sect4">
<h5 id="how_to_extend">How to extend</h5>
<div class="paragraph">
<p>To add additional configuration (similar to users and locales), create an implementation of the <code>ConfigurationResolver</code> class and in the <code>applyConfiguration</code> method implement the necessary usage of the configuration.</p>
</div>
<div class="paragraph">
<p>For example, as implemented in <code>LocaleConfigurationResolver</code></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="nd">@Service</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">LocaleConfigurationResolver</span> <span class="kd">extends</span> <span class="nc">ConfigurationResolver</span> <span class="o">{</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="nc">String</span> <span class="nf">getType</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="s">"locale"</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">applyConfiguration</span><span class="o">(</span><span class="nc">String</span> <span class="n">value</span><span class="o">,</span> <span class="nc">TestExecutionContext</span> <span class="n">testExecutionContext</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">try</span> <span class="o">{</span>
            <span class="n">testExecutionContext</span><span class="o">.</span><span class="na">addPram</span><span class="o">(</span><span class="nc">Consts</span><span class="o">.</span><span class="na">CTX_LOCALE</span><span class="o">,</span> <span class="k">new</span> <span class="nc">Locale</span><span class="o">(</span><span class="n">value</span><span class="o">));</span>
        <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="nc">Exception</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">log</span><span class="o">.</span><span class="na">error</span><span class="o">(</span><span class="s">"Unable to set locale "</span> <span class="o">+</span> <span class="n">value</span><span class="o">,</span> <span class="n">e</span><span class="o">);</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>If your resolver requires reading additional data as user is, you need to implement class <code>ConfigurationDataReader</code>.</p>
</div>
<div class="paragraph">
<p>This implementation is used to transform loaded data into strictly typed data.
Due to the fact that the reading of this configuration occurs before the initialization of the Spring context, another mechanism is used to provide dynamic resolvers behavior, and you need to register the created resolver using the mechanism <a href="https://docs.oracle.com/javase/tutorial/sound/SPI-intro.html">SPI</a></p>
</div>
<div class="paragraph">
<p>Here is an example of how this mechanism works by example.
(This is how <code>UserConfigurationResolver</code> works).</p>
</div>
<div class="paragraph">
<p><a href="#additional_config">In the configuration files</a> we use only aliases, for example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="json5"> "user": "admin",</code></pre>
</div>
</div>
<div class="paragraph">
<p>However, additional data is needed to build a complete full-featured user object.
This data is stored in the <code>execute\data\%resolverType%</code> directory (in case of using json file storage for configuration), it is read by the basic configuration reader and then a transformation method is applied to it from the corresponding data reader, and it transforms Map&lt;String, Object&gt; into an object with typed values.</p>
</div>
<div class="paragraph">
<p>Thus, the <code>UserDataReader</code> may look like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">UserDataReader</span> <span class="kd">extends</span> <span class="nc">JsonConfigurationDataReader</span><span class="o">&lt;</span><span class="nc">DefaultYafUser</span><span class="o">&gt;</span> <span class="o">{</span>
    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="nc">String</span> <span class="nf">getType</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="s">"user"</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="nc">Map</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">,</span> <span class="nc">DefaultYafUser</span><span class="o">&gt;</span> <span class="nf">transformData</span><span class="o">(</span><span class="nc">Map</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">,</span> <span class="nc">Object</span><span class="o">&gt;</span> <span class="n">dataMap</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">mapper</span><span class="o">.</span><span class="na">convertValue</span><span class="o">(</span><span class="n">dataMap</span><span class="o">,</span> <span class="k">new</span> <span class="nc">TypeReference</span><span class="o">&lt;</span><span class="nc">Map</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">,</span> <span class="nc">DefaultYafUser</span><span class="o">&gt;&gt;()</span> <span class="o">{</span>
        <span class="o">});</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>As conversion to DefaultYafUser is used json data must have the same structure as the class:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="json5">{
  "admin": {
    "username": "admin1",
    "password": "qwRNTdh"
  }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="config-reading">Config reading</h4>
<div class="paragraph">
<p>The framework allows you to store configurations in various forms, and for this it is necessary to implement the <code>BaseExecutionReader</code>.Basically, the framework implements reading from JSON. <mark>(!TBD link)</mark></p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="data-management">Data Management</h3>
<div class="paragraph">
<p>To facilitate working with structured data, the framework provides a special mechanism that allows you to inject POJO objects into the test depending on the execution context.</p>
</div>
<div class="paragraph">
<p>The basic implementation is based on storing data files in JSON format, but it can be reconfigured.</p>
</div>
<div class="sect3">
<h4 id="how-to-2">How to</h4>
<div class="sect4">
<h5 id="how-to-use-2">How to use</h5>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>First of all data is a separate YAF module that isn&#8217;t accessible by default and additional dependence are required to be added</p>
<details>
<summary class="title">Maven</summary>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="xml"><span class="nt">&lt;dependency&gt;</span>
    <span class="nt">&lt;groupId&gt;</span>com.coherentsolutions.yaf<span class="nt">&lt;/groupId&gt;</span>
    <span class="nt">&lt;artifactId&gt;</span>yaf-data<span class="nt">&lt;/artifactId&gt;</span>
    <span class="nt">&lt;version&gt;</span>${yaf.version}<span class="nt">&lt;/version&gt;</span>
<span class="nt">&lt;/dependency&gt;</span></code></pre>
</div>
</div>
</div>
</details>
<details>
<summary class="title">Gradle</summary>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="groovy"><span class="n">dependencies</span> <span class="o">{</span>
    <span class="n">implementation</span><span class="o">(</span><span class="s2">"com.coherentsolutions.yaf:yaf-data:${yaf.version}"</span><span class="o">)</span>
<span class="o">}</span></code></pre>
</div>
</div>
</div>
</details>
</li>
<li>
<p>Configuration (Optional)</p>
<div class="paragraph">
<p>If you want to use a different data format than JSON, or use a different folder, specify this in the <code>yaf.data&#8230;&#8203;.</code> properties in YAF configuration file.</p>
</div>
</li>
<li>
<p>Create a json file in <code>data</code> folder resource or other if <code>dataFolder</code> property was defined on step 1</p>
</li>
<li>
<p>In the test class, declare a POJO object for the required data.</p>
</li>
<li>
<p>Annotate it with <code>@YafData</code> specifying the required file name.
After creating an instance of the test class, this object will be filled with data from the specified file(step 2).</p>
</li>
</ol>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
Please note that the initialization (filling) of the data object happens once when creating an instance of the test class, if you need to have a new data generated for each test - define <code>alwaysNew</code> YafData property to true.
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
All data that comes into this mechanism is processed by the template engine (<a href="link:./com/coherentsolutions/yaf/data/templates/MustacheTemplateService.html">MustacheTemplateService</a>) and the localizer (<a href="link:./com/coherentsolutions/yaf/core/l10n/L10nService.html">L10nService</a>).
</td>
</tr>
</table>
</div>
<div class="sect5">
<h6 id="faker">Faker</h6>
<div class="paragraph">
<p>To generate unique data Java Faker could be used. To write dynamic data files the first thing to know is the calculated parts are inside double curly braces. There are some Faker usage cases in the following example, more could be found here <a href="https://javadoc.io/doc/com.github.javafaker/javafaker/latest/com/github/javafaker/Faker.html">Java Faker</a></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="json"><span class="p">{</span><span class="w">
  </span><span class="nl">"website"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://{{faker.internet.url}}"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"domain"</span><span class="p">:</span><span class="w"> </span><span class="s2">"{{faker.internet.domainName}}"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"firstName"</span><span class="p">:</span><span class="w"> </span><span class="s2">"{{faker.name.firstName}}"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"lastName"</span><span class="p">:</span><span class="w"> </span><span class="s2">"{{faker.name.lastName}}"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"jobTitle"</span><span class="p">:</span><span class="w"> </span><span class="s2">"{{faker.job.position}}"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"isActive"</span><span class="p">:</span><span class="w"> </span><span class="s2">"{{faker.bool}}"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"companyName"</span><span class="p">:</span><span class="w"> </span><span class="s2">"{{faker.company.name}}"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"startDate"</span><span class="p">:</span><span class="w"> </span><span class="s2">"{{faker.date.past(100, java.util.concurrent.TimeUnit.DAYS)}}"</span><span class="w">
</span><span class="p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Let&#8217;s pay attention at <code>startDate</code> property. After this file processed <code>startDate</code> POJO class&#8217;s property will happen to stay as it was. To fix the problem faker&#8217;s methods that expected to get at least one argument should be used in a little bit another way:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="nd">@Component</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">CustomFaker</span> <span class="kd">implements</span> <span class="nc">CustomTemplateFunctions</span> <span class="o">{</span>

    <span class="kd">public</span> <span class="nc">String</span> <span class="nf">past</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="nc">String</span><span class="o">.</span><span class="na">valueOf</span><span class="o">(</span><span class="k">new</span> <span class="nc">Faker</span><span class="o">().</span><span class="na">date</span><span class="o">().</span><span class="na">past</span><span class="o">(</span><span class="mi">100</span><span class="o">,</span> <span class="nc">TimeUnit</span><span class="o">.</span><span class="na">DAYS</span><span class="o">));</span>
    <span class="o">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="nc">String</span> <span class="nf">getKeyName</span><span class="o">()</span> <span class="o">{</span> <i class="conum" data-value="1"></i><b>(1)</b>
        <span class="k">return</span> <span class="s">"date"</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
&lt;1&gt; The method returns the prefix name to use it to apply to new CustomTemplateFunctions methods. Here could be oe or more methods implementing custom functionality that extends Faker&#8217;s one and wrapping Faker&#8217;s method that expects arguments to be passed
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>In json file it will look like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="json"><span class="p">{</span><span class="w">
</span><span class="err">...</span><span class="w">
  </span><span class="nl">"startDate"</span><span class="p">:</span><span class="w"> </span><span class="s2">"{{date.past()}}"</span><span class="w">
</span><span class="p">}</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect4">
<h5 id="how-to-extend">How to extend</h5>
<div class="paragraph">
<p>This mechanism can be extended by implementing your own data reader, for example, XmlDataReader or ApiDataReader.
You can see the implementation of the reader in the example of <code>JsonDataReader</code> <mark>(!TBD link)</mark>.
And it is also necessary to create an additional annotation that "overrides" <code>@YafData</code> and specify the created reader there.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="nd">@Retention</span><span class="o">(</span><span class="nc">RetentionPolicy</span><span class="o">.</span><span class="na">RUNTIME</span><span class="o">)</span>
<span class="nd">@Target</span><span class="o">({</span> <span class="nc">ElementType</span><span class="o">.</span><span class="na">TYPE</span> <span class="o">})</span>
<span class="nd">@Inherited</span>
<span class="nd">@Documented</span>
<span class="nd">@YafData</span><span class="o">(</span><span class="n">reader</span> <span class="o">=</span> <span class="nc">ApiDataReader</span><span class="o">.</span><span class="na">class</span><span class="o">)</span>
<span class="kd">public</span> <span class="nd">@interface</span> <span class="nc">ApiYafData</span> <span class="o">{</span>
    <span class="nc">String</span> <span class="nf">url</span><span class="o">();</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
"overrides" here means mark "child" ApiYafData annotation by "parent" YafData defining custom Reader class as reader attribute or other attributes if necessary. Also, here is a custom data annotation attribute url installed of YafData&#8217;s fileName as source of data here is a api resource, not file
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="nd">@Component</span> <i class="conum" data-value="1"></i><b>(1)</b>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">ApiDataReader</span> <span class="kd">extends</span> <span class="nc">BaseFileReader</span> <span class="o">{</span> <i class="conum" data-value="2"></i><b>(2)</b>

    <span class="nd">@Autowired</span>
    <span class="nc">RestAssuredYafRequest</span> <span class="n">request</span><span class="o">;</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="nc">Object</span> <span class="nf">readData</span><span class="o">(</span><span class="nc">YafData</span> <span class="n">yafData</span><span class="o">,</span> <span class="nc">Class</span><span class="o">&lt;?&gt;</span> <span class="n">objType</span><span class="o">,</span> <span class="nc">TestExecutionContext</span> <span class="n">executionContext</span><span class="o">)</span> <span class="o">{</span>
        <span class="nc">String</span> <span class="n">url</span> <span class="o">=</span> <span class="n">objType</span><span class="o">.</span><span class="na">getAnnotation</span><span class="o">(</span><span class="nc">ApiYafData</span><span class="o">.</span><span class="na">class</span><span class="o">).</span><span class="na">url</span><span class="o">();</span> <i class="conum" data-value="3"></i><b>(3)</b>
        <span class="k">return</span> <span class="n">request</span><span class="o">.</span><span class="na">anonymousReq</span><span class="o">(</span><span class="s">"GET"</span><span class="o">,</span> <span class="n">url</span><span class="o">).</span><span class="na">jsonPath</span><span class="o">().</span><span class="na">getObject</span><span class="o">(</span><span class="n">objType</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Any reader is required to extend BaseFileReader class &lt;2&gt; and be a spring component &lt;1&gt;.  readData signature includes YafData annotation and ApiYafData custom attributes are not accessible. To solve this problem reflection under objType(the object type the data annotation was applied to) is used in &lt;3&gt; line.
</td>
</tr>
</table>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
BaseFileReader class contains templates processing methods
</td>
</tr>
</table>
</div>
</div>
<div class="sect4">
<h5 id="how-it-works-2">How it works</h5>
<div class="paragraph">
<p>The implementation of this approach is based on the mechanism of post-processing of the fields:
On test is starting YAF checks all the field to be processable by any of registered processors or post-processors. If suitable processor is found the field and/or its value will be handled and changed</p>
</div>
<div class="paragraph">
<p>The <code>DataFieldPostProcessor</code> is used to process data fields.
In case the field is annotated with a reader, it is used to read the data and initialize the field the following way:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Processor get a reader from the data annotation and execute it if necessary</p>
</li>
<li>
<p>Reader get data(json data for JsonDataReader) by the file name from file and convert the data on his way</p>
</li>
<li>
<p>The file name is searched in the following places (in descending order of priority):</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>In the annotation `@YafData.fileName'</p>
</li>
<li>
<p>In the annotation <code>@YafTest.dataFile</code> .</p>
</li>
<li>
<p>In the annotation <code>@YafTest.testName</code> .</p>
</li>
<li>
<p>Using the test method name</p>
</li>
</ol>
</div>
</li>
<li>
<p>The data is also processed by template service (<a href="https://mustache.github.io">mustache</a>) applying Faker and CustomTemplateFunctions</p>
</li>
</ol>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="api">API</h3>
<div class="paragraph">
<p>To simplify the work with API requests, several items have been implemented in YAF:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Special abstraction level of API client.</p>
</li>
<li>
<p>Authorization provider mechanism.</p>
</li>
</ol>
</div>
<div class="sect3">
<h4 id="api-client-abstraction-level">API Client abstraction level</h4>
<div class="paragraph">
<p>A special abstraction level of API client allows replacing API client implementation.
This level operates such classes as <code>YafRequest</code>, <code>AuthProvider</code>,
<code>YafApiUser</code>, thereby allowing the user to override any of the components on this level.</p>
</div>
<div class="paragraph">
<p>The basic <code>YafRequest</code> contract has a support for 4 main HTTP methods, both anonymous and authorized.</p>
</div>
</div>
<div class="sect3">
<h4 id="implementation">Implementation</h4>
<div class="paragraph">
<p>YAF provide a RestAssured implementation (the guide <a href="api_restassured_en.adoc">RestAssured sample</a>). To write own implementation (Java HTTP Client or other framework) it is required to implement your own YafRequest</p>
</div>
<div class="sect4">
<h5 id="how-to-use-3">How to use</h5>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Implement YafRequest. YafRequest is a generic type so two types should be defined implementing it. T type is a type representing request as configuration before it is sent, R is a type represents a response (should be mutable, so it will be called as request config further). The following YafRequest interface methods are required to implement defining you own api implementation:</p>
<div class="ulist">
<ul>
<li>
<p>T anonymousReq() - get default request config without auth applied</p>
</li>
<li>
<p>T req() - get request config with default user auth applied. the source of default user could be taken from <a href="config.adoc">config</a>, properties or constructor/builder</p>
</li>
<li>
<p>T req(YafApiUser user) - get request config with provided user auth applied. YafApiUser here is an interface and before using this method in tests it is useful to implement it as a POJO with required for auth info (usually login/password)</p>
</li>
<li>
<p>YafRequest addHeader(String key, String value)</p>
</li>
<li>
<p>YafRequest queryParam(String key, String value)</p>
</li>
<li>
<p>YafRequest queryParams(Map params)</p>
</li>
<li>
<p>ApiProperties getProps() - return api properties</p>
</li>
<li>
<p>R anonymousReq(String method, String url, Object&#8230;&#8203; body) - execute request with no auth applied. Do not forget to use headers and queryParams set before send the request (valid for every req method)</p>
</li>
<li>
<p>R req(String method, String url, Object&#8230;&#8203; body) - execute request with default user auth applied</p>
</li>
<li>
<p>R req(YafApiUser user, String method, String url, Object&#8230;&#8203; body) - execute request with provided user auth applied</p>
<div class="paragraph">
<p>For following examples java.net.http is used:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">HttpYafRequest</span> <span class="kd">implements</span> <span class="nc">YafRequest</span><span class="o">&lt;</span><span class="nc">HttpRequest</span><span class="o">.</span><span class="na">Builder</span><span class="o">,</span> <span class="nc">HttpResponse</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;&gt;</span> <span class="o">{</span>

    <span class="nc">AuthProvider</span> <span class="n">authProvider</span><span class="o">;</span><i class="conum" data-value="1"></i><b>(1)</b>

    <span class="nd">@Autowired</span>
    <span class="nc">ApiProperties</span> <span class="n">properties</span><span class="o">;</span><i class="conum" data-value="2"></i><b>(2)</b>

    <span class="c1">// builder or constructor</span>

    <span class="c1">// abstract methods implementation</span>

    <span class="nd">@PostConstruct</span> <i class="conum" data-value="3"></i><b>(3)</b>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">init</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">reqSpec</span><span class="o">.</span><span class="na">uri</span><span class="o">(</span><span class="k">new</span> <span class="no">URI</span><span class="o">(</span><span class="n">properties</span><span class="o">.</span><span class="na">getBaseUrl</span><span class="o">()));</span>
        <span class="c1">//...</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
&lt;1&gt; To perform request required authorization using user YafApiUser AuthProvider is used. On the YafRequest initialization authProvider entity must be wierd with its yaf request entity using setRequest method of AuthProvider to set authorization headers to request config when your yaf request implementation suggest to make authorized requests to api.
That also means one thing waste to remember setting provider entity from outside (for example through constructor/builder): new provider entity should be used for each yaf request entity.
</td>
</tr>
</table>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
&lt;2&gt; To read api properties from application properties ApiProperties or child type field is required. The main nuance the Autowired annotation is used to organize a Spring easy access to properties defined in properties files via using @ConfigurationProperties on a @Bean Method defining a YafRequest bean. Pay attention that these properties are set after constructor invocation, so in case of using properties for initialization(for ex, set some common or base url/header/queryParams, logging) it is recommended to perform it inside bean @PostConstruct method or afterPropertiesSet method of InitializingBean interface &lt;3&gt;
</td>
</tr>
</table>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>AuthProvider</p>
<div class="paragraph">
<p>The main role of AuthProvider is management of token-user pair, execution of authorization requests, tracking the token&#8217;s lifetime and "signing" the requests.</p>
</div>
<div class="paragraph">
<p><strong>How does it work?</strong> There are three stages AuthProvider is responsible for. auth method aimed to manage tokens: provide actual token if exists for the user or init the request to api for the new one (getAuthToken method) and finally trigger apply auth stage (applyAuth method) where token is applied on request config in defined way. Creating your own AuthProvider you are obligated to provide your own getAuthToken and applyAuth methods.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">HttpAuthProvider</span> <span class="kd">extends</span> <span class="nc">AuthProvider</span><span class="o">&lt;</span><span class="nc">HttpRequest</span><span class="o">.</span><span class="na">Builder</span><span class="o">&gt;</span> <span class="o">{</span>

    <span class="nd">@Override</span>
    <span class="kd">protected</span> <span class="nc">AuthToken</span> <span class="nf">getAuthToken</span><span class="o">(</span><span class="nc">YafApiUser</span> <span class="n">user</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">YafApiRequestException</span> <span class="o">{</span>
        <span class="nc">HttpResponse</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;</span> <span class="n">response</span> <span class="o">=</span> <span class="o">((</span><span class="nc">HttpResponse</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;)</span> <span class="n">request</span><span class="o">.</span><span class="na">anonymousReq</span><span class="o">(</span>
                    <span class="s">"post"</span><span class="o">,</span> <span class="s">"/api/auth/password"</span><span class="o">,</span> <span class="n">user</span><span class="o">));</span>
        <span class="k">if</span><span class="o">(</span><span class="n">response</span><span class="o">.</span><span class="na">statusCode</span><span class="o">()</span> <span class="o">!=</span> <span class="mi">200</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">throw</span> <span class="k">new</span> <span class="nf">YafApiRequestException</span><span class="o">(</span><span class="s">"Faild to get token: status: "</span> <span class="o">+</span> <span class="n">response</span><span class="o">.</span><span class="na">statusCode</span><span class="o">());</span>
        <span class="o">}</span>
        <span class="nc">String</span> <span class="n">userToken</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="na">body</span><span class="o">();</span>
        <span class="c1">//convert token to AuthToken</span>
        <span class="nc">AuthToken</span> <span class="n">token</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">AuthToken</span><span class="o">();</span>
        <span class="n">token</span><span class="o">.</span><span class="na">setToken</span><span class="o">(</span><span class="n">userToken</span><span class="o">);</span>
        <span class="k">return</span> <span class="n">token</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="nd">@Override</span>
    <span class="kd">protected</span> <span class="kt">void</span> <span class="nf">applyAuth</span><span class="o">(</span><span class="nc">AuthToken</span> <span class="n">token</span><span class="o">,</span> <span class="nc">HttpRequest</span><span class="o">.</span><span class="na">Builder</span> <span class="n">req</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">req</span><span class="o">.</span><span class="na">header</span><span class="o">(</span><span class="no">AUTHORIZATION</span><span class="o">,</span> <span class="no">BEARER</span> <span class="o">+</span> <span class="s">" "</span> <span class="o">+</span> <span class="n">token</span><span class="o">.</span><span class="na">getToken</span><span class="o">());</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Also, in your config class define a bean for each API</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="java">    <span class="nd">@Bean</span><span class="o">(</span><span class="s">"one"</span><span class="o">)</span>
    <span class="nd">@Primary</span>
    <span class="nd">@ConfigurationProperties</span><span class="o">(</span><span class="n">prefix</span><span class="o">=</span><span class="s">"yaf.api.first-api"</span><span class="o">)</span>
    <span class="kd">public</span> <span class="nc">HttpYafRequest</span> <span class="nf">one</span><span class="o">()</span> <span class="o">{</span> <i class="conum" data-value="1"></i><b>(1)</b>
        <span class="c1">//...</span>
    <span class="o">}</span>

    <span class="nd">@Bean</span><span class="o">(</span><span class="s">"two"</span><span class="o">)</span>
    <span class="nd">@ConfigurationProperties</span><span class="o">(</span><span class="n">prefix</span><span class="o">=</span><span class="s">"yaf.api.second-api"</span><span class="o">)</span>
    <span class="kd">public</span> <span class="nc">HttpYafRequest</span> <span class="nf">two</span><span class="o">()</span> <span class="o">{</span>
        <span class="c1">//...</span>
    <span class="o">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>To use this requests define dependence in your test class</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="c1">//for first API</span>
    <span class="nd">@Autowired</span>
    <span class="nc">YafRequest</span> <span class="n">yafRequest</span><span class="o">;</span>

<span class="c1">//or</span>
    <span class="nd">@Autowired</span>
    <span class="nc">YafRequest</span> <span class="n">one</span><span class="o">;</span>

<span class="c1">//or</span>
    <span class="nd">@Autowired</span>
    <span class="nd">@Qualifier</span><span class="o">(</span><span class="s">"one"</span><span class="o">)</span>
    <span class="nc">YafRequest</span> <span class="n">one</span><span class="o">;</span>

<span class="c1">///------------------</span>

<span class="c1">//for second API</span>

    <span class="nd">@Autowired</span>
    <span class="nc">YafRequest</span> <span class="n">two</span><span class="o">;</span>

<span class="c1">//or</span>
    <span class="nd">@Autowired</span>
    <span class="nd">@Qualifier</span><span class="o">(</span><span class="s">"two"</span><span class="o">)</span>
    <span class="nc">YafRequest</span> <span class="n">two</span><span class="o">;</span></code></pre>
</div>
</div>
</li>
<li>
<p><a id="set_properties"></a>In your <code>application.properties</code> file add props for several APIs like below (using additional name after <code>api</code>, unique for each API). The example shows how to define more than one api</p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="properties"><span class="py">yaf.api.first-api.props.baseUrl</span><span class="p">=</span><span class="s">https://xxxx</span>
<span class="py">yaf.api.second-api.props.baseUrl</span><span class="p">=</span><span class="s">https://yyyy</span>
<i class="conum" data-value="1"></i><b>(1)</b>
<span class="err">yaf.api.first-api.props.{apiPropertiesClassFieldName}={value}</span>
<span class="err">yaf.api.second-api.props.baseUrl.{apiPropertiesClassMapFieldName}</span><span class="py">.key</span><span class="p">=</span><span class="s">value</span></code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
&lt;1&gt; You can specify all options you need from <a href="../javadoc/com/coherentsolutions/yaf/core/api/ApiProperties.html">ApiProperties</a> class.
</td>
</tr>
</table>
</div>
</li>
<li>
<p>Extending APIs properties (optional)</p>
<div class="paragraph">
<p>Create class <code>XXXProperties</code> and extend it from <code>ApiProperties</code> class, adding your custom properties as fields. Mark this class with <code>@Primary</code> annotation.</p>
</div>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="nd">@Primary</span>
<span class="nd">@Data</span>
<span class="nd">@EqualsAndHashCode</span><span class="o">(</span><span class="n">callSuper</span> <span class="o">=</span> <span class="kc">true</span><span class="o">)</span>
<span class="nd">@Configuration</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">SApiProperties</span> <span class="kd">extends</span> <span class="nc">ApiProperties</span> <span class="o">{</span>

    <span class="nc">String</span> <span class="n">extKey</span><span class="o">;</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Use it in your YafRequest class as it showed above just changing properties field type. As well, it is possible to use in AuthProvider or somewhere else with <code>cast</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">SAuthProvider</span> <span class="kd">extends</span> <span class="nc">AuthProvider</span> <span class="o">{</span>

    <span class="nd">@Override</span>
    <span class="kd">protected</span> <span class="nc">AuthToken</span> <span class="nf">getAuthToken</span><span class="o">(</span><span class="nc">ApiUser</span> <span class="n">user</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">YafApiRequestException</span> <span class="o">{</span>
        <span class="nc">SApiProperties</span> <span class="n">properties</span> <span class="o">=</span> <span class="o">(</span><span class="nc">SApiProperties</span><span class="o">)</span> <span class="n">request</span><span class="o">.</span><span class="na">getProps</span><span class="o">();</span>
        <span class="n">properties</span><span class="o">.</span><span class="na">getExtKey</span><span class="o">();</span>

    <span class="o">}</span>
<span class="o">}</span></code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="conditions">Conditions</h3>
<div class="paragraph">
<p>To provide a flexible test configuration with the necessary beans, a special mechanism was designed.
If you mark a certain bean with a specialized annotation, the necessary implementation will be selected at the moment of its injection, depending on the test execution context.</p>
</div>
<div class="paragraph">
<p>For example, you have several implementations of a page (PageObject) depending on the screen resolution.
In the test class, the basic implementation of this page is declared, different inheritors ("child-objects") are labeled with special annotations.
When a page is initialized, depending on the conditions described in the annotations and the test context, a necessary implementation will be injected.</p>
</div>
<div class="sect3">
<h4 id="how-to-3">How to</h4>
<div class="sect4">
<h5 id="how-to-use-4">How to use</h5>
<div class="paragraph">
<p>In specific framework modules, there is a standard set of conditional annotations, such as <code>@Android</code>, <code>@Chrome</code>, and so on.</p>
</div>
<div class="paragraph">
<p>To use them, you need to:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Create an abstract core page (or any other yaf bean), such as <code>LoginPage</code>, which is inherited from <code>Page</code> or <code>Component</code> or <code>Utils</code> or any of their inheritors.</p>
</li>
<li>
<p>Create its inheritors, which will define the conditions of their creation.</p>
</li>
<li>
<p>Annotate the inheritors with necessary annotations.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>You can also use core annotation <code>@YafCondition</code> and specify the necessary parameters in it.</p>
</div>
<div class="paragraph">
<p>If you need more than standard annotations, you can create your own annotation, the inheritor of YafCondition, by specifying necessary parameters in it.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kd">public</span> <span class="nd">@interface</span> <span class="nc">YafCondition</span> <span class="o">{</span>

    <span class="nc">DeviceType</span> <span class="nf">deviceType</span><span class="o">()</span> <span class="k">default</span> <span class="nc">DeviceType</span><span class="o">.</span><span class="na">OTHER</span><span class="o">;</span>

    <span class="no">OS</span> <span class="nf">os</span><span class="o">()</span> <span class="k">default</span> <span class="no">OS</span><span class="o">.</span><span class="na">OTHER</span><span class="o">;</span>

    <span class="nc">MobileOS</span> <span class="nf">mobileOs</span><span class="o">()</span> <span class="k">default</span> <span class="nc">MobileOS</span><span class="o">.</span><span class="na">OTHER</span><span class="o">;</span>

    <span class="nc">String</span> <span class="nf">mobileOsVersion</span><span class="o">()</span> <span class="k">default</span> <span class="nc">Strings</span><span class="o">.</span><span class="na">EMPTY</span><span class="o">;</span>

    <span class="nc">Browser</span> <span class="nf">browser</span><span class="o">()</span> <span class="k">default</span> <span class="nc">Browser</span><span class="o">.</span><span class="na">OTHER</span><span class="o">;</span>

    <span class="nc">String</span> <span class="nf">browserVersion</span><span class="o">()</span> <span class="k">default</span> <span class="nc">Strings</span><span class="o">.</span><span class="na">EMPTY</span><span class="o">;</span>

    <span class="nc">String</span> <span class="nf">appVersion</span><span class="o">()</span> <span class="k">default</span> <span class="nc">Strings</span><span class="o">.</span><span class="na">EMPTY</span><span class="o">;</span>

    <span class="nc">String</span> <span class="nf">osVersion</span><span class="o">()</span> <span class="k">default</span> <span class="nc">Strings</span><span class="o">.</span><span class="na">EMPTY</span><span class="o">;</span>

    <span class="kt">int</span> <span class="nf">width</span><span class="o">()</span> <span class="k">default</span> <span class="mi">0</span><span class="o">;</span>

    <span class="kt">int</span> <span class="nf">height</span><span class="o">()</span> <span class="k">default</span> <span class="mi">0</span><span class="o">;</span>

    <span class="kt">boolean</span> <span class="nf">simulator</span><span class="o">()</span> <span class="k">default</span> <span class="kc">false</span><span class="o">;</span>
<span class="o">}</span></code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="how-to-extend-2">How to extend</h5>
<div class="paragraph">
<p>As mentioned above, you can create your own annotations.
In case you are not going to simply "fix" some annotation parameters, as for example <strong>browser = chrome</strong>, you will need your own implementation of <code>ConditionMather</code>.
An example can be seen here - <code>BaseConditionMatcher</code> <em><mark>(!!  )</mark></em></p>
</div>
</div>
<div class="sect4">
<h5 id="how-it-works-3">How it works</h5>
<div class="paragraph">
<p>At the time the field is processed by <code>YafContextFieldPostProcessor</code>, information about the implementations (inheritors) of the given type is analyzed and if there are several ones, the <code>ConditionMatchService</code> is used to calculate points (score) on how well the given implementation matches the environment of the current test.
The scoring is based on the comparison between the given properties in the condition annotation and the devices for which the test is performed.</p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="yaf-reporting">YAF reporting</h3>
<div class="paragraph">
<p>YAF contains basic reporting functionality.
This implementation is a basic one, and we suggest extending it or using a production one.</p>
</div>
<div class="sect3">
<h4 id="how-to-4">How to</h4>
<div class="sect4">
<h5 id="how-to-use-5">How to use</h5>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Add a report module dependency</p>
<details>
<summary class="title">Maven</summary>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="xml"><span class="nt">&lt;dependency&gt;</span>
            <span class="nt">&lt;groupId&gt;</span>com.coherentsolutions.yaf<span class="nt">&lt;/groupId&gt;</span>
            <span class="nt">&lt;artifactId&gt;</span>yaf-report<span class="nt">&lt;/artifactId&gt;</span>
            <span class="nt">&lt;version&gt;</span>${yaf.version}<span class="nt">&lt;/version&gt;</span>
<span class="nt">&lt;/dependency&gt;</span></code></pre>
</div>
</div>
</div>
</details>
<details>
<summary class="title">Gradle</summary>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="groovy"><span class="n">dependencies</span> <span class="o">{</span>
    <span class="n">implementation</span><span class="o">(</span><span class="s2">"com.coherentsolutions.yaf:yaf-report:${yaf.version}"</span><span class="o">)</span>
<span class="o">}</span></code></pre>
</div>
</div>
</div>
</details>
</li>
<li>
<p>Enable the reporting service <code>yaf.report.enabled=true</code> in YAF configuration file.</p>
</li>
<li>
<p>Configure it if necessary based on available options (<code>YafReportProperties</code>):</p>
<div class="ulist">
<ul>
<li>
<p>enable report logging (by default, it is shown in the console);</p>
</li>
<li>
<p>change/create a new report template (using the <a href="https://velocity.apache.org/engine/1.7/user-guide.html">Velocity</a> templating tool).</p>
</li>
<li>
<p>specify the path to the report template or default one will be used;</p>
</li>
</ul>
</div>
</li>
</ol>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
There is one more property in <code>YafReportProperties</code> contextName that is a name of variable in template to map the result report to. Pay attention on its value creating your own report
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="properties"><span class="py">yaf.report.enabled</span><span class="p">=</span><span class="s">true</span>
<span class="py">yaf.report.logReport</span><span class="p">=</span><span class="s">true</span>
<span class="py">yaf.report.template</span><span class="p">=</span><span class="s">"templates/report.vm";</span></code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="how-to-extend-3">How to extend</h5>
<div class="paragraph">
<p>There are two options to modify the reporter:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Changing the report template (see example <code>templates/executionReport.vm</code>).</p>
</li>
<li>
<p>Change the algorithm of the report processing. You can not just output it to the console, but, for instance, form a pdf document and send it via email. For this, you need to subscribe to the event <code>ExecutionReportReadyEvent</code> and add aditional processing logic.</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="nd">@Service</span>
<span class="nd">@Slf4j</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">SendEmailPdfReportService</span> <span class="o">{</span>

    <span class="nd">@EventListener</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">sendPdfReport</span><span class="o">(</span><span class="nc">ExecutionReportReadyEvent</span> <span class="n">event</span><span class="o">)</span> <span class="o">{</span>
        <span class="nc">PdfDocument</span> <span class="n">pdf</span> <span class="o">=</span> <span class="n">pdfService</span><span class="o">.</span><span class="na">generate</span><span class="o">(</span><span class="n">event</span><span class="o">.</span><span class="na">getReport</span><span class="o">());</span>
        <span class="n">emailService</span><span class="o">.</span><span class="na">sendPdf</span><span class="o">(</span><span class="n">getSubEmailList</span><span class="o">(),</span> <span class="n">pdf</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="o">...</span>
<span class="o">}</span></code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="how-it-works-4">How it works</h5>
<div class="paragraph">
<p>The <code>ReportService</code> class listens to events as the tests are running, aggregates them in the <code>ExecutionReport</code> object and when the <code>ExecutionFinishEvent</code> event occurs, this class completes the <code>ExecutionReport</code>, prints it (outputs to the console) using the <code>PrintReportService</code> and also generates the <code>ExecutionReportReadyEvent</code> event, which can be further processed by custom handlers.</p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="slack">Slack</h3>
<div class="paragraph">
<p>One such handler implemented by YAF is an event processor that sends a report to a Slack</p>
</div>
<div class="sect3">
<h4 id="how-to-use-6">How to use</h4>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>To use the functionality it is required to add slack module dependency (the module is already includes report module):</p>
<details>
<summary class="title">Maven</summary>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="xml"><span class="nt">&lt;dependency&gt;</span>
            <span class="nt">&lt;groupId&gt;</span>com.coherentsolutions.yaf<span class="nt">&lt;/groupId&gt;</span>
            <span class="nt">&lt;artifactId&gt;</span>yaf-slack<span class="nt">&lt;/artifactId&gt;</span>
            <span class="nt">&lt;version&gt;</span>${yaf.version}<span class="nt">&lt;/version&gt;</span>
<span class="nt">&lt;/dependency&gt;</span></code></pre>
</div>
</div>
</div>
</details>
<details>
<summary class="title">Gradle</summary>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="groovy"><span class="n">dependencies</span> <span class="o">{</span>
    <span class="n">implementation</span><span class="o">(</span><span class="s2">"com.coherentsolutions.yaf:yaf-slack:${yaf.version}"</span><span class="o">)</span>
<span class="o">}</span></code></pre>
</div>
</div>
</div>
</details>
</li>
<li>
<p>Continue adding Slack properties in properties file.
There are two ways how to get access to the channel to send the report to. Every require to create an App for Slack Workspace:</p>
<div class="ulist">
<ul>
<li>
<p>using apiToken and channelId, see <a href="https://api.slack.com/messaging/sending#getting_started">how to get permissions</a></p>
</li>
<li>
<p>usinga webhook, see <a href="https://api.slack.com/messaging/webhooks">how to create a Webhook</a> for the channel</p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="properties"><span class="py">yaf.report.enabled</span><span class="p">=</span><span class="s">true</span>
<span class="c"># yaf.report. ...
</span><span class="py">yaf.slack.enabled</span><span class="p">=</span><span class="s">true</span>
<span class="py">yaf.slack.sendReport</span><span class="p">=</span><span class="s">true</span>

<span class="py">yaf.slack.apiToken</span><span class="p">=</span><span class="s">xoxb-111-111-xxxxxxxxx</span>
<span class="py">yaf.slack.channelId</span><span class="p">=</span><span class="s">XX1XX111X</span>
<span class="c"># or
</span><span class="py">yaf.slack.webhookUrl</span><span class="p">=</span><span class="s">https://hooks.slack.com/services/T00000000/B00000000/XXXXXXXXXXXXXXXXXXXXXXXX</span></code></pre>
</div>
</div>
</li>
</ul>
</div>
</li>
</ol>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
apiToken is a bot(starts with <code>xoxb-</code>) or user(starts with <code>xoxp-</code>) token.
channelId is the ID of the Slack channel where the message will be posted, could be found at the bottom of the channel 'About' tab in slack application
</td>
</tr>
</table>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
yaf.report.enabled=true is required or else ExecutionReport won&#8217;t be collected and <code>ExecutionReportReadyEvent</code> event won&#8217;t be published
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect2">
<h3 id="utils">Utils</h3>
<div class="paragraph">
<p>There are numerous utilities in YAF that are designed to make test development easier.</p>
</div>
<div class="sect3">
<h4 id="localization">Localization</h4>
<div class="paragraph">
<p>The standard Spring localization mechanism <mark>(!TBD link)</mark> and the main class that implements it - <code>L10nService</code> - are used to provide localization in YAF.
This service can use resources both with an explicitly specified locale and with a locale set in <code>TestExecutionContext</code> (accordingly, the localization may be test-dependent).</p>
</div>
<div class="paragraph">
<p>This mechanism is also automatically used in the templating engine.</p>
</div>
</div>
<div class="sect3">
<h4 id="templates-engine">Templates engine</h4>
<div class="paragraph">
<p>For dynamic processing of strings (files), the framework has a templating mechanism (class <code>TemplateService</code>).
Two template engines are supported:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><a href="https://github.com/spullara/mustache.java">Mustache</a> - used by default, for localization and elsewhere.</p>
</li>
<li>
<p><a href="https://velocity.apache.org/">Velocity</a> - additional implementation, used to generate the final test execution report.</p>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="store">Store</h4>
<div class="paragraph">
<p>In YAF two types of additional storage are implemented:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><code>FileStore</code> <mark>(!TBD link)</mark> - a wrapper over the usual file storage.
For example, it is used to store downloaded versions of mobile apps.</p>
</li>
<li>
<p><code>YafDbRepository</code> <mark>(!TBD link)</mark> - Spring boot repository on top of <a href="https://rocksdb.org/">RocksDB</a>  (key-value store).
Objects that are stored in this DB should be Serializable.
To use this store just @Autowire <code>YafDbRepository</code> and use provided methods.
Default DB name is <code>tmpdb</code>, you can change it in properties <code>yaf.tempdb.name=&#8230;&#8203;</code>.</p>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="yaf-utils">YAF utils</h4>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>YafReflectionUtils</p>
</li>
<li>
<p>YafBeanUtils (be careful, some methods of this class are cached</p>
</li>
<li>
<p>YafBy</p>
</li>
</ol>
</div>
<div class="sect4">
<h5 id="user-extended-yaf-utils">User extended YAF utils</h5>
<div class="paragraph">
<p>If a developer wants to create utilities that work as context-dependently as, for example, PageObjects <mark>(!!  )</mark>, he needs to inherit this utility classes from the <code>Utils</code> class and mark them with the corresponding <code>@Condition</code> annotation.</p>
</div>
</div>
<div class="sect4">
<h5 id="misc-utils">Misc utils</h5>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Capabilities Utils</p>
</li>
<li>
<p>Date Utils</p>
</li>
<li>
<p>File Utils</p>
</li>
<li>
<p>Properties Utils</p>
</li>
<li>
<p>Safe Parse</p>
</li>
</ol>
</div>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Version 0.3.4<br>
Last updated 2025-05-04 15:18:48 UTC
</div>
</div>
</body>
</html>